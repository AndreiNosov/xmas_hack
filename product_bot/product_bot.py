import pandas as pd
from transformers import AutoModelForSequenceClassification, AutoTokenizer

# Загрузка обученной модели
model = AutoModelForSequenceClassification.from_pretrained('intel/neural-chat-7b-v3-1', num_labels=4)
tokenizer = AutoTokenizer.from_pretrained('intel/neural-chat-7b-v3-1')

# Функция для генерации рекомендаций и отчета по развитию клиентов
def generate_report(product_purpose, product_name):
    # Токенизация входных данных
    inputs = tokenizer(product_purpose, product_name, return_tensors='pt')

    # Прогноз модели
    outputs = model(**inputs)
    
    # Извлечение вероятностей для каждой области
    likelihoods = outputs.logits.detach().numpy()

    # Подготовка рекомендаций, включая метку и вероятность
    recommendations = [{'метка': label, 'вероятность': likelihood} for label, likelihood in zip(['финансы', 'эффективность', 'процесс покупки', 'поддержка'], likelihoods[0])]

    # Генерация отчета по развитию клиентов
    report = {
        'название_продукта': product_name,
        'цель_продукта': product_purpose,
        'рекомендации': recommendations
    }

    return report

# Функция для продолжения тестирования
def продолжить_тестирование():
    продолжить = input('Хотите продолжить тестирование? (да/нет): ')
    if продолжить.lower() == 'да':
        цель_продукта_новая = input('Введите новую цель продукта: ')
        название_продукта_новое = input('Введите название нового продукта: ')
        отчет_новый = generate_report(цель_продукта_новая, название_продукта_новое)
        print("\nОтчет по развитию клиентов для", отчет_новый['название_продукта'])
        print("Цель продукта:", отчет_новый['цель_продукта'])
        print("Рекомендации:")
        df_новый = pd.DataFrame(отчет_новый['рекомендации'])
        print(df_новый)
        продолжить_тестирование()

# Тестирование на примерах
цель_продукта = 'Ферма трейдинговых чат-ботов.'
название_продукта = 'Ферма чат-ботов для трейдинга'
отчет = generate_report(цель_продукта, название_продукта)
print("Отчет по развитию клиентов для", отчет['название_продукта'])
print("Цель продукта:", отчет['цель_продукта'])
print("Рекомендации:")
df = pd.DataFrame(отчет['рекомендации'])
print(df)

# Продолжение тестирования
print("\nПродолжим тестирование с новой стратегией:")
цель_продукта_2 = 'Продажа манго через маркетплейс.'
название_продукта_2 = 'Продажа манго через маркет-плейс'
отчет_2 = generate_report(цель_продукта_2, название_продукта_2)
print("\nОтчет по развитию клиентов для", отчет_2['название_продукта'])
print("Цель продукта:", отчет_2['цель_продукта'])
print("Рекомендации:")
df_2 = pd.DataFrame(отчет_2['рекомендации'])
print(df_2)

# Продолжение тестирования с предложением ввести новую цель и название продукта
print  
